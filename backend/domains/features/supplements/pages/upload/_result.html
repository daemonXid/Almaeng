<!-- OCR Analysis Result Partial -->
<div id="ocr-result" class="p-6 rounded-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700">
    <div class="flex items-center gap-3 mb-6">
        <span class="text-3xl">âœ…</span>
        <div>
            <h3 class="font-semibold text-gray-900 dark:text-white">ë¶„ì„ ì™„ë£Œ!</h3>
            <p class="text-sm text-gray-500">{{ filename }}</p>
        </div>
    </div>

    <!-- Product Info -->
    <div class="mb-6 p-4 rounded-xl bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800">
        <div class="grid grid-cols-2 gap-4 text-sm">
            <div>
                <span class="text-gray-500 dark:text-gray-400">ì œí’ˆëª…</span>
                <p class="font-medium text-gray-900 dark:text-white">{{ product_name|default:"ì•Œ ìˆ˜ ì—†ìŒ" }}</p>
            </div>
            <div>
                <span class="text-gray-500 dark:text-gray-400">ë¸Œëœë“œ</span>
                <p class="font-medium text-gray-900 dark:text-white">{{ brand|default:"ì•Œ ìˆ˜ ì—†ìŒ" }}</p>
            </div>
            <div>
                <span class="text-gray-500 dark:text-gray-400">1íšŒ ì„­ì·¨ëŸ‰</span>
                <p class="font-medium text-gray-900 dark:text-white">{{ serving_size|default:"ì •ë³´ ì—†ìŒ" }}</p>
            </div>
            <div>
                <span class="text-gray-500 dark:text-gray-400">ì´ ì„­ì·¨íšŸìˆ˜</span>
                <p class="font-medium text-gray-900 dark:text-white">{{ servings_count|default:1 }}íšŒë¶„</p>
            </div>
        </div>
    </div>

    <!-- Extracted Ingredients -->
    <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-4">
        ğŸ“‹ ì¶”ì¶œëœ ì„±ë¶„ ({{ ingredients|length }}ê°œ)
    </h4>

    <div class="space-y-2 max-h-64 overflow-y-auto">
        {% for ingredient in ingredients %}
        <div class="flex items-center justify-between p-3 rounded-xl bg-gray-50 dark:bg-gray-700/50">
            <span class="font-medium text-gray-900 dark:text-white">{{ ingredient.name }}</span>
            <span class="text-emerald-600 dark:text-emerald-400">
                {{ ingredient.amount }} {{ ingredient.unit }}
                {% if ingredient.daily_value %}
                <span class="text-xs text-gray-400 ml-1">({{ ingredient.daily_value }})</span>
                {% endif %}
            </span>
        </div>
        {% empty %}
        <p class="text-gray-500 text-sm text-center py-4">ì¶”ì¶œëœ ì„±ë¶„ì´ ì—†ìŠµë‹ˆë‹¤</p>
        {% endfor %}
    </div>

    <!-- Actions -->
    {% if user.is_authenticated %}
    <form hx-post="{% url 'supplements:save_ocr' %}"
          hx-target="#ocr-result"
          hx-swap="outerHTML"
          class="mt-6">
        {% csrf_token %}
        <input type="hidden" name="product_name" value="{{ product_name }}">
        <input type="hidden" name="brand" value="{{ brand }}">
        <input type="hidden" name="serving_size" value="{{ serving_size }}">
        <input type="hidden" name="servings_count" value="{{ servings_count }}">
        <!-- JSONìœ¼ë¡œ ì„±ë¶„ ì „ë‹¬ -->
        <input type="hidden" name="ingredients" value='{{ ingredients_json }}'>

        <div class="flex gap-3">
            <button type="submit"
                    class="flex-1 px-4 py-3 rounded-xl bg-emerald-600 hover:bg-emerald-700 text-white font-medium transition-colors flex items-center justify-center gap-2">
                <span>ğŸ’¾</span>
                <span>ì´ ì œí’ˆ ì €ì¥í•˜ê¸°</span>
            </button>
            <a href="{% url 'supplements:search_direct' %}?q={{ product_name|urlencode }}"
               class="flex-1 px-4 py-3 rounded-xl bg-sky-500 hover:bg-sky-600 text-white font-medium transition-colors flex items-center justify-center gap-2">
                <span>ğŸ”</span>
                <span>ìœ ì‚¬ ì œí’ˆ ì°¾ê¸°</span>
            </a>
        </div>
    </form>
    {% else %}
    <div class="mt-6">
        <a href="{% url 'account_login' %}?next={% url 'supplements:upload' %}"
           class="block w-full px-4 py-3 rounded-xl bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium transition-colors text-center">
            ğŸ”’ ë¡œê·¸ì¸í•˜ê³  ì €ì¥í•˜ê¸°
        </a>
    </div>
    {% endif %}
</div>
