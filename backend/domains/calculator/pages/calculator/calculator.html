{% extends "base.html" %}
{% load static %}

{% block title %}Î∞îÎîî Í≥ÑÏÇ∞Í∏∞ - ÏïåÎßπAI{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 py-8 px-4">
    <div class="max-w-4xl mx-auto">
        <!-- Ìó§Îçî -->
        <div class="text-center mb-8">
            <div class="inline-flex items-center gap-2 px-4 py-2 bg-brand-100 dark:bg-brand-900/30 rounded-full mb-4">
                <span class="text-2xl">üí™</span>
                <span class="text-sm font-semibold text-brand-600 dark:text-brand-400">Body Calculator</span>
            </div>
            <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-3">
                Î∞îÎîî Í≥ÑÏÇ∞Í∏∞
            </h1>
            <p class="text-gray-600 dark:text-gray-400 text-lg">
                Í≥ºÌïôÏ†ÅÏù∏ Í≥µÏãùÏúºÎ°ú ÎãπÏã†Ïùò Î™©Ìëú ÏπºÎ°úÎ¶¨ÏôÄ ÏòÅÏñëÏÜåÎ•º Í≥ÑÏÇ∞Ìï¥ÎìúÎ¶ΩÎãàÎã§
            </p>
        </div>

        <!-- Í≥ÑÏÇ∞Í∏∞ Ìèº -->
        <div class="card-toss mb-8">
            <form method="post" class="space-y-6">
                {% csrf_token %}

                <!-- ÏóêÎü¨ Î©îÏãúÏßÄ -->
                {% if error %}
                <div class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-700 dark:text-red-400">
                    {{ error }}
                </div>
                {% endif %}

                <!-- Í∏∞Î≥∏ Ï†ïÎ≥¥ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- ÏÑ±Î≥Ñ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                            ÏÑ±Î≥Ñ
                        </label>
                        <div class="flex gap-3">
                            <label class="flex-1">
                                <input type="radio" name="gender" value="male" checked class="peer sr-only">
                                <div class="chip-toss cursor-pointer text-center peer-checked:bg-brand-500 peer-checked:text-white">
                                    ÎÇ®ÏÑ±
                                </div>
                            </label>
                            <label class="flex-1">
                                <input type="radio" name="gender" value="female" class="peer sr-only">
                                <div class="chip-toss cursor-pointer text-center peer-checked:bg-brand-500 peer-checked:text-white">
                                    Ïó¨ÏÑ±
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- ÎÇòÏù¥ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                            ÎÇòÏù¥
                        </label>
                        <input type="number" name="age" value="25" min="10" max="100" required
                               class="input-toss">
                    </div>
                </div>

                <!-- Ïã†Ï≤¥ Ï†ïÎ≥¥ -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- ÌÇ§ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                            ÌÇ§ (cm)
                        </label>
                        <input type="number" name="height_cm" value="170" min="100" max="250" step="0.1" required
                               class="input-toss">
                    </div>

                    <!-- Î™∏Î¨¥Í≤å -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                            Î™∏Î¨¥Í≤å (kg)
                        </label>
                        <input type="number" name="weight_kg" value="70" min="30" max="300" step="0.1" required
                               class="input-toss">
                    </div>

                    <!-- Ï≤¥ÏßÄÎ∞©Î•† (ÏÑ†ÌÉù) -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                            Ï≤¥ÏßÄÎ∞©Î•† (%, ÏÑ†ÌÉù)
                        </label>
                        <input type="number" name="body_fat_percent" min="3" max="60" step="0.1"
                               placeholder="ÏÑ†ÌÉùÏÇ¨Ìï≠"
                               class="input-toss">
                    </div>
                </div>

                <!-- ÌôúÎèôÎüâ -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">
                        ÌôúÎèôÎüâ
                    </label>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
                        <label>
                            <input type="radio" name="activity_level" value="sedentary" class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center text-xs peer-checked:bg-brand-500 peer-checked:text-white">
                                Í±∞Ïùò Ïïà Ìï®
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="activity_level" value="light" class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center text-xs peer-checked:bg-brand-500 peer-checked:text-white">
                                Í∞ÄÎ≤ºÏö¥ Ïö¥Îèô
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="activity_level" value="moderate" checked class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center text-xs peer-checked:bg-brand-500 peer-checked:text-white">
                                Ï§ëÍ∞Ñ Í∞ïÎèÑ
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="activity_level" value="active" class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center text-xs peer-checked:bg-brand-500 peer-checked:text-white">
                                Í≤©Î†¨Ìïú Ïö¥Îèô
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="activity_level" value="very_active" class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center text-xs peer-checked:bg-brand-500 peer-checked:text-white">
                                Îß§Ïö∞ Í≤©Î†¨
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Î™©Ìëú -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">
                        Î™©Ìëú
                    </label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <label>
                            <input type="radio" name="goal" value="cut" class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center peer-checked:bg-accent-red peer-checked:text-white">
                                Îã§Ïù¥Ïñ¥Ìä∏
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="goal" value="maintain" checked class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center peer-checked:bg-brand-500 peer-checked:text-white">
                                Ïú†ÏßÄ
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="goal" value="lean" class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center peer-checked:bg-accent-green peer-checked:text-white">
                                Î¶∞Îß§Ïä§ÏóÖ
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="goal" value="bulk" class="peer sr-only">
                            <div class="chip-toss cursor-pointer text-center peer-checked:bg-accent-yellow peer-checked:text-white">
                                Î≤åÌÅ¨ÏóÖ
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Í≥ÑÏÇ∞ Î≤ÑÌäº -->
                <button type="submit" class="btn-toss w-full py-4 text-lg">
                    üí™ Í≥ÑÏÇ∞ÌïòÍ∏∞
                </button>
            </form>
        </div>

        <!-- Í≤∞Í≥º ÌëúÏãú -->
        {% if result %}
        <div class="space-y-6">
            <!-- Î™©Ìëú ÏπºÎ°úÎ¶¨ (Î©îÏù∏) -->
            <div class="card-toss bg-gradient-to-br from-brand-500 to-brand-600 text-white">
                <div class="text-center">
                    <div class="text-sm font-medium opacity-90 mb-2">
                        {{ result.goal_label }} Î™©Ìëú
                        {% if result.goal_adjustment_percent != 0 %}
                        ({{ result.goal_adjustment_percent|stringformat:"+d" }}%)
                        {% endif %}
                    </div>
                    <div class="text-5xl font-bold mb-2">
                        {{ result.target_calories|floatformat:0 }}
                    </div>
                    <div class="text-lg opacity-90">
                        kcal / Ïùº
                    </div>
                </div>
            </div>

            <!-- Í∏∞Ï¥à Ï†ïÎ≥¥ -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card-toss">
                    <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">Í∏∞Ï¥à ÎåÄÏÇ¨Îüâ (BMR)</div>
                    <div class="text-3xl font-bold text-gray-900 dark:text-white">
                        {{ result.bmr|floatformat:0 }} <span class="text-lg text-gray-500">kcal</span>
                    </div>
                </div>
                <div class="card-toss">
                    <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">Ï¥ù ÏÜåÎπÑ ÏπºÎ°úÎ¶¨ (TDEE)</div>
                    <div class="text-3xl font-bold text-gray-900 dark:text-white">
                        {{ result.tdee|floatformat:0 }} <span class="text-lg text-gray-500">kcal</span>
                    </div>
                </div>
            </div>

            <!-- Îß§ÌÅ¨Î°ú ÏòÅÏñëÏÜå -->
            <div class="card-toss">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
                    Í∂åÏû• ÏòÅÏñëÏÜå (Îß§ÌÅ¨Î°ú)
                </h3>
                <div class="grid grid-cols-3 gap-4">
                    <!-- Îã®Î∞±Ïßà -->
                    <div class="text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl">
                        <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">Îã®Î∞±Ïßà</div>
                        <div class="text-3xl font-bold text-blue-600 dark:text-blue-400">
                            {{ result.protein_g }}
                        </div>
                        <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">g / Ïùº</div>
                    </div>
                    <!-- ÌÉÑÏàòÌôîÎ¨º -->
                    <div class="text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-xl">
                        <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">ÌÉÑÏàòÌôîÎ¨º</div>
                        <div class="text-3xl font-bold text-yellow-600 dark:text-yellow-400">
                            {{ result.carbs_g }}
                        </div>
                        <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">g / Ïùº</div>
                    </div>
                    <!-- ÏßÄÎ∞© -->
                    <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-xl">
                        <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">ÏßÄÎ∞©</div>
                        <div class="text-3xl font-bold text-green-600 dark:text-green-400">
                            {{ result.fat_g }}
                        </div>
                        <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">g / Ïùº</div>
                    </div>
                </div>
            </div>

            <!-- ÏïàÎÇ¥ Î¨∏Íµ¨ -->
            <div class="ai-disclaimer text-center">
                ‚ö†Ô∏è Î≥∏ Í≥ÑÏÇ∞ Í≤∞Í≥ºÎäî Ï∞∏Í≥†Ïö©Ïù¥Î©∞, Í∞úÏù∏Ïùò Í±¥Í∞ï ÏÉÅÌÉúÏóê Îî∞Îùº Îã§Î•º Ïàò ÏûàÏäµÎãàÎã§.
                Ï†ÑÎ¨∏Í∞ÄÏôÄ ÏÉÅÎã¥ ÌõÑ ÏãùÎã®ÏùÑ Ï°∞Ï†ïÌïòÏÑ∏Ïöî.
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
