{% extends "base.html" %}
{% load static i18n %}

{% block title %}ì•Œë§¹AI - Gemini ê¸°ë°˜ AI ì‡¼í•‘ ë„ìš°ë¯¸{% endblock %}

{% block content %}
<main class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 pb-24 font-sans">
    <div class="max-w-4xl mx-auto px-5 pt-12">
        <!-- Logo & Powered By -->
        <header class="text-center mb-8">
            <div class="inline-flex items-center gap-3 mb-4">
                <img src="{% static 'images/logo-almaeng.svg' %}" alt="ì•Œë§¹AI" class="h-16 w-auto">
            </div>
            <div class="inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 rounded-full shadow-sm border border-gray-100 dark:border-gray-700">
                <span class="text-sm text-gray-600 dark:text-gray-400">Powered by</span>
                <span class="text-sm font-bold bg-gradient-to-r from-brand-500 to-brand-600 bg-clip-text text-transparent">
                    Gemini AI
                </span>
                <div class="ai-badge">
                    âœ¨ AI
                </div>
            </div>
        </header>

        <!-- Mascot & Greeting -->
        <section class="text-center mb-10">
            <!-- ìºì¹˜ ë§ˆìŠ¤ì½”íŠ¸ (ë³‘ì•„ë¦¬ ì´ë¯¸ì§€) -->
            <div class="mb-6 animate-float">
                <div class="inline-block p-6 bg-gradient-to-br from-yellow-100 to-orange-100 dark:from-yellow-900/30 dark:to-orange-900/30 rounded-full shadow-lg">
                    <!-- TODO: ì‚¬ìš©ì ì œê³µ ë³‘ì•„ë¦¬ ì´ë¯¸ì§€ë¡œ êµì²´ -->
                    <span class="text-8xl">ğŸ£</span>
                </div>
            </div>
            
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4 leading-tight">
                {% if user.is_authenticated %}
                ì•ˆë…•í•˜ì„¸ìš”, {{ user.get_short_name|default:user.username }}ë‹˜! ğŸ‘‹<br>
                {% else %}
                ì•ˆë…•í•˜ì„¸ìš”! ğŸ‘‹<br>
                {% endif %}
                <span class="bg-gradient-to-r from-brand-500 to-brand-600 bg-clip-text text-transparent">
                    ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?
                </span>
            </h1>
            <p class="text-lg text-gray-600 dark:text-gray-400">
                ê¶ê¸ˆí•œ ê²ƒì„ ììœ ë¡­ê²Œ ë¬¼ì–´ë³´ì„¸ìš”. AIê°€ ë‹µë³€í•´ë“œë¦½ë‹ˆë‹¤.
            </p>
        </section>

        <!-- Chat Messages Area (HTMX Streaming) -->
        <section id="chatMessages" class="mb-6 space-y-4 min-h-[200px]">
            <!-- ì±„íŒ… ë©”ì‹œì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </section>

        <!-- Search/Question Input -->
        <section class="mb-8">
            <form 
                id="chatForm" 
                hx-post="{% url 'ai_chatbot:send_new' %}" 
                hx-target="#chatMessages" 
                hx-swap="beforeend"
                hx-on::after-request="this.reset(); document.getElementById('chatInput').focus()"
                class="relative"
            >
                {% csrf_token %}
                <div class="relative">
                    <textarea 
                        id="chatInput"
                        name="message" 
                        placeholder="ì˜ˆ: ëˆˆ í”¼ë¡œì— ì¢‹ì€ ì˜ì–‘ì œ ì¶”ì²œí•´ì¤˜"
                        rows="3"
                        class="input-toss w-full resize-none pr-16"
                        required
                        autocomplete="off"
                    ></textarea>
                    <button 
                        type="submit"
                        class="absolute right-3 bottom-3 btn-toss px-4 py-2 text-sm"
                    >
                        ì „ì†¡
                    </button>
                </div>
            </form>
        </section>

        <!-- Quick Question Buttons -->
        <section class="mb-10">
            <p class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4">ğŸ’¡ ë¹ ë¥¸ ì§ˆë¬¸</p>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                <button 
                    type="button"
                    onclick="document.getElementById('chatInput').value = '20ë§Œì›ëŒ€ ë¬´ì„  ì´ì–´í° ì¶”ì²œí•´ì¤˜'; document.getElementById('chatForm').requestSubmit()"
                    class="chip-toss text-left"
                >
                    <span class="text-xl mr-2">ğŸ§</span>
                    <span class="text-sm">20ë§Œì›ëŒ€ ë¬´ì„  ì´ì–´í°</span>
                </button>
                <button 
                    type="button"
                    onclick="document.getElementById('chatInput').value = 'í—ˆë¦¬ ì•„í”Œ ë•Œ ì¢‹ì€ ì˜ì ì¶”ì²œ'; document.getElementById('chatForm').requestSubmit()"
                    class="chip-toss text-left"
                >
                    <span class="text-xl mr-2">ğŸª‘</span>
                    <span class="text-sm">í—ˆë¦¬ì— ì¢‹ì€ ì˜ì</span>
                </button>
                <button 
                    type="button"
                    onclick="document.getElementById('chatInput').value = 'ë‹¨ë°±ì§ˆ ë³´ì¶©ì œ ì¶”ì²œí•´ì¤˜'; document.getElementById('chatForm').requestSubmit()"
                    class="chip-toss text-left"
                >
                    <span class="text-xl mr-2">ğŸ’ª</span>
                    <span class="text-sm">ë‹¨ë°±ì§ˆ ë³´ì¶©ì œ</span>
                </button>
                <button 
                    type="button"
                    onclick="document.getElementById('chatInput').value = 'ìº í•‘ìš© íœ´ëŒ€ìš© ì„ í’ê¸° ì°¾ì•„ì¤˜'; document.getElementById('chatForm').requestSubmit()"
                    class="chip-toss text-left"
                >
                    <span class="text-xl mr-2">ğŸ•ï¸</span>
                    <span class="text-sm">ìº í•‘ìš© ì„ í’ê¸°</span>
                </button>
                <button 
                    type="button"
                    onclick="document.getElementById('chatInput').value = 'ëˆˆ ê±´ê°•ì— ì¢‹ì€ ì˜ì–‘ì œ ì¶”ì²œ'; document.getElementById('chatForm').requestSubmit()"
                    class="chip-toss text-left"
                >
                    <span class="text-xl mr-2">ğŸ‘ï¸</span>
                    <span class="text-sm">ëˆˆ ê±´ê°• ì˜ì–‘ì œ</span>
                </button>
                <button 
                    type="button"
                    onclick="document.getElementById('chatInput').value = 'ê°€ì„±ë¹„ ì¢‹ì€ ë¸”ë£¨íˆ¬ìŠ¤ ìŠ¤í”¼ì»¤'; document.getElementById('chatForm').requestSubmit()"
                    class="chip-toss text-left"
                >
                    <span class="text-xl mr-2">ğŸ”Š</span>
                    <span class="text-sm">ë¸”ë£¨íˆ¬ìŠ¤ ìŠ¤í”¼ì»¤</span>
                </button>
            </div>
        </section>

        <!-- Service Notice (ì•±ì¸í† ìŠ¤ ì •ì±… ì¤€ìˆ˜) -->
        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mb-6">
            <p class="text-sm text-blue-900 dark:text-blue-300 mb-2 font-semibold">
                â„¹ï¸ ì„œë¹„ìŠ¤ ì•ˆë‚´
            </p>
            <p class="text-xs text-blue-800 dark:text-blue-400 mb-2">
                ë³¸ ì„œë¹„ìŠ¤ëŠ” ìƒí’ˆì„ ì¶”ì²œí•˜ë©°, <strong>ì‹¤ì œ êµ¬ë§¤ëŠ” ì¿ íŒ¡, ë„¤ì´ë²„ ì‡¼í•‘, 11ë²ˆê°€ ë“± ì™¸ë¶€ ì‡¼í•‘ëª°ì—ì„œ ì§„í–‰</strong>ë©ë‹ˆë‹¤.
            </p>
            <p class="text-xs text-blue-700 dark:text-blue-500">
                ìƒí’ˆ í´ë¦­ ì‹œ í•´ë‹¹ ì‡¼í•‘ëª°ë¡œ ì´ë™í•˜ë©°, ì•Œë§¹AIëŠ” ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ í™œë™ì„ í†µí•´ ì¼ì •ì•¡ì˜ ìˆ˜ìˆ˜ë£Œë¥¼ ì œê³µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
        </div>

        <!-- AI Disclaimer (ì¸ê³µì§€ëŠ¥ê¸°ë³¸ë²• ì¤€ìˆ˜) -->
        <div class="ai-disclaimer text-center mb-6">
            <p class="mb-2">
                âš ï¸ ë³¸ ì„œë¹„ìŠ¤ëŠ” <strong>ìƒì„±í˜• AI(Gemini)</strong> ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. 
                ì œê³µë˜ëŠ” ì •ë³´ëŠ” ì°¸ê³ ìš©ì´ë©°, ìµœì¢… êµ¬ë§¤ ê²°ì •ì€ ì‚¬ìš©ì ë³¸ì¸ì´ í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.
            </p>
            <p class="text-xs text-gray-400 dark:text-gray-500">
                ì¸ê³µì§€ëŠ¥ê¸°ë³¸ë²• ì œ15ì¡°(ì¸ê³µì§€ëŠ¥ ì´ìš©ì ë“±ì˜ ê¶Œë¦¬ ë“±) ì¤€ìˆ˜
            </p>
        </div>

        <!-- Footer Info -->
        <footer class="text-center text-xs text-gray-500 dark:text-gray-400 py-6 border-t border-gray-200 dark:border-gray-700">
            <p class="mb-2">
                <span class="font-semibold">ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤</span> Â· 
                <span class="font-semibold">ë„¤ì´ë²„ ì‡¼í•‘</span> Â· 
                <span class="font-semibold">11ë²ˆê°€</span> ì‹¤ì‹œê°„ ê°€ê²© ì—°ë™
            </p>
            <p class="text-gray-400 dark:text-gray-500">
                Â© 2026 ì•Œë§¹AI Â· Powered by Gemini AI
            </p>
        </footer>
    </div>
</main>

<script>
// Auto-scroll to bottom when new messages arrive
htmx.on('htmx:afterSwap', function(evt) {
    if (evt.detail.target.id === 'chatMessages') {
        evt.detail.target.scrollIntoView({ behavior: 'smooth', block: 'end' });
    }
});

// Enter to submit (Shift+Enter for new line)
document.getElementById('chatInput').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        document.getElementById('chatForm').requestSubmit();
    }
});
</script>
{% endblock %}
