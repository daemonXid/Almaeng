{% load humanize %}

{% if queries %}
<div class="overflow-x-auto">
    <table class="w-full text-sm">
        <thead>
            <tr class="text-left text-gray-500 dark:text-gray-400 border-b border-gray-200 dark:border-gray-700">
                <th class="pb-3 font-medium">쿼리</th>
                <th class="pb-3 font-medium text-right">호출 수</th>
                <th class="pb-3 font-medium text-right">평균 (ms)</th>
                <th class="pb-3 font-medium text-right">총합 (ms)</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
            {% for q in queries %}
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50">
                <td class="py-3 pr-4">
                    <code class="text-xs text-gray-600 dark:text-gray-300 font-mono break-all">
                        {{ q.query|truncatechars:80 }}
                    </code>
                </td>
                <td class="py-3 text-right text-gray-900 dark:text-white">{{ q.calls|intcomma }}</td>
                <td class="py-3 text-right">
                    <span class="{% if q.avg_time_ms > 500 %}text-red-500{% elif q.avg_time_ms > 200 %}text-yellow-500{% else %}text-gray-600 dark:text-gray-400{% endif %}">
                        {{ q.avg_time_ms }}
                    </span>
                </td>
                <td class="py-3 text-right text-gray-500">{{ q.total_time_ms|intcomma }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="text-center py-8 text-gray-500 dark:text-gray-400">
    <span class="text-4xl block mb-2">✨</span>
    <p>느린 쿼리가 없습니다!</p>
    <p class="text-sm mt-1">(또는 pg_stat_statements 확장이 활성화되지 않음)</p>
</div>
{% endif %}
